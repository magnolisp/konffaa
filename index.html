<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>Konffaa</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewselflink" data-pltdoc="x">Konffaa</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="index.html#%28part._konffaa-lang%29" class="tocviewlink" data-pltdoc="x">Variant Specification Language</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="index.html#%28part._konffaa-cli%29" class="tocviewlink" data-pltdoc="x">Command-<wbr></wbr>Line Interface</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="index.html#%28part._.Shell_.Completion%29" class="tocviewlink" data-pltdoc="x">Shell Completion</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="index.html#%28part._konffaa-license%29" class="tocviewlink" data-pltdoc="x">License</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._konffaa%29" class="tocsubseclink" data-pltdoc="x">Konffaa</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._konffaa-lang%29" class="tocsubseclink" data-pltdoc="x">Variant Specification Language</a></td></tr><tr><td><a href="#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-variant%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>variant</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-variant%2A%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>variant*</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-variant%2A%2A%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>variant**</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-attribute%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>attribute</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-field%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>field</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-axiom%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>axiom</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._konffaa%2Fmain..rkt%29._assert%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">assert</span></span></a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._konffaa-cli%29" class="tocsubseclink" data-pltdoc="x">Command-<wbr></wbr>Line Interface</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Shell_.Completion%29" class="tocsubseclink" data-pltdoc="x">Shell Completion</a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._konffaa-license%29" class="tocsubseclink" data-pltdoc="x">License</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="versionNoNav">6.5</span></div><h2><a name="(part._konffaa)"></a>Konffaa</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Tero Hasu</p></span></div><p><a name="(tech._konffaa)"></a><span style="font-style: italic">Konffaa</span> is a lightweight configuration manager originally created for the <a href="https://github.com/contextlogger/">ContextLogger2</a> project.
Konffaa aims to work with different build managers and scripts by generating build information in different languages.
It consists of a <span class="stt">konffaa</span> command-line tool and a <a href="index.html#%28mod-path._konffaa%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">konffaa</span></a> project configuration specification language.</p><h3>1<tt>&nbsp;</tt><a name="(part._konffaa-lang)"></a><a name="(mod-path._konffaa)"></a>Variant Specification Language</h3><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><a href="http://docs.racket-lang.org/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="index.html#%28mod-path._konffaa%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">konffaa</span></a></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <span class="stt">konffaa</span></span></td></tr></table></p><p>The <a href="index.html#%28mod-path._konffaa%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">konffaa</span></a> language exports all of <a href="http://docs.racket-lang.org/reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket</span></a>, as well as additional forms for defining variants and their attributes.</p><p>For defining a variant, you may use the <span class="RktSym"><a href="index.html#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-variant%29%29" class="RktStxLink" data-pltdoc="x">define-variant</a></span>, <span class="RktSym"><a href="index.html#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-variant%2A%29%29" class="RktStxLink" data-pltdoc="x">define-variant*</a></span>, and <span class="RktSym"><a href="index.html#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-variant%2A%2A%29%29" class="RktStxLink" data-pltdoc="x">define-variant**</a></span> forms. The one-star form is like the no-star form, except that it <span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span>s the defined variant. The two-star form both <span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span>s the variant under its original name, plus it also provides it as the &ldquo;main&rdquo; import of the module, so that the <span class="stt">konffaa</span> command will find it.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._konffaa/main..rkt)._define-variant))"></a><span title="Provided from: konffaa | Package: konffaa"><span class="RktSym"><a href="index.html#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-variant%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define-variant</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">base-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">body</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._konffaa/main..rkt)._define-variant*))"></a><span title="Provided from: konffaa | Package: konffaa"><span class="RktSym"><a href="index.html#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-variant%2A%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define-variant*</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">base-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">body</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._konffaa/main..rkt)._define-variant**))"></a><span title="Provided from: konffaa | Package: konffaa"><span class="RktSym"><a href="index.html#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-variant%2A%2A%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define-variant**</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">base-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">body</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></p></blockquote></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Defines a product variant, binding it as <span class="RktVar">id</span>.
The variant inherits from other variants as specified by <span class="RktVar">base-expr</span><span class="stt"> </span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span>.
The <span class="RktVar">body</span><span class="stt"> </span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span> of a definition should contain attributes, fields, and axioms specifying the variant and its constraints.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._konffaa/main..rkt)._define-attribute))"></a><span title="Provided from: konffaa | Package: konffaa"><span class="RktSym"><a href="index.html#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-attribute%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define-attribute</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">value-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._konffaa/main..rkt)._define-field))"></a><span title="Provided from: konffaa | Package: konffaa"><span class="RktSym"><a href="index.html#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-field%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define-field</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">value-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></p></blockquote></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Defines a variant attribute or field, naming it as <span class="RktVar">id</span>.
Its value is given by the last of the <span class="RktVar">value-expr</span>essions.
The difference between the two forms is that only the former defines fields whose values get output; consequently, those values should be serializable. Inheritance works for both kinds of fields.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._konffaa/main..rkt)._define-axiom))"></a><span title="Provided from: konffaa | Package: konffaa"><span class="RktSym"><a href="index.html#%28form._%28%28lib._konffaa%2Fmain..rkt%29._define-axiom%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define-axiom</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">assert-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Defines an axiom, naming it as <span class="RktVar">id</span>.
The <span class="RktVar">assert-expr</span>essions would typically contain one or more <span class="RktSym"><a href="index.html#%28form._%28%28lib._konffaa%2Fmain..rkt%29._assert%29%29" class="RktStxLink" data-pltdoc="x">assert</a></span>ions.
Axioms can be inherited between variants in the same way as fields are.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._konffaa/main..rkt)._assert))"></a><span title="Provided from: konffaa | Package: konffaa"><span class="RktSym"><a href="index.html#%28form._%28%28lib._konffaa%2Fmain..rkt%29._assert%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">assert</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">test-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-msg</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">maybe-msg</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">message</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">An assertion to use within an axiom.
An optional <span class="RktVar">message</span> may be provided, in addition to a <span class="RktVar">test-expr</span>ession which should hold for the containing axiom to hold.</div></p><p>See the source code of the modules <span class="stt">"attribute.rkt"</span>, <span class="stt">"axiom.rkt"</span>, and <span class="stt">"surface.rkt"</span> for more details about the <a href="index.html#%28mod-path._konffaa%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">konffaa</span></a> DSL.</p><p>For examples of variant configuration files, see the <span class="stt">"variants"</span> directory of the source distribution.</p><h3>2<tt>&nbsp;</tt><a name="(part._konffaa-cli)"></a>Command-Line Interface</h3><p><div class="SIntrapara">The idea with configuring a project for a specific build variant with Konffaa is simple: you invoke <span class="stt">konffaa</span> for a specific configuration <span class="RktVar">variant</span> as its command-line argument:
</div><div class="SIntrapara"><span class="hspace">&nbsp;&nbsp;</span><span class="stt">konffaa </span><span class="RktVar">variant</span></div><div class="SIntrapara">The <span class="RktVar">variant</span> may either name a variant specification file, or it may be a variant name, whose filename is then assumed to be <span class="stt">"variants/<span class="RktVar">variant</span>.var.rkt"</span>.</div></p><p>When correctly invoked, the <span class="stt">konffaa</span> program will then process the specified variant-describing input file by computing a full set of attributes for that variant, which&#8212;<wbr></wbr>if the associated axioms hold&#8212;<wbr></wbr>are then output essentially as sets of key-value pairs in different file formats. Those output files will then reflect the selected variant configuration until such time that <span class="stt">konffaa</span> is invoked again to choose a different configuration.</p><p>The generated include files are only touched when they actually change as a result of the change in configuration, which allows Konffaa to work better with build managers (such as Make) whose dependency checking is based on timestamps.</p><p>The generated include files are intended to be used to configure other development tools (most notably build managers) in a variant-specific way.</p><p>Konffaa presently supports GNU Make and <span class="stt">qmake</span> as foreign output languages, as well as C and Ruby, with the latter ones aimed at configuring programs and custom build scripts. Scripts can be particularly useful for driving template-based generation of input files for more obscure build tools that use non-standard file formats.</p><h3>3<tt>&nbsp;</tt><a name="(part._.Shell_.Completion)"></a>Shell Completion</h3><p>Completion of variant names based on the <span class="stt">".var.rkt"</span> suffixed files found in the <span class="stt">"variants"</span> directory is supported for the <span class="stt">konffaa</span> command in the Bash shell. That support is provided by the <span class="stt">"bash_completion"</span> file in the source distribution.</p><h3>4<tt>&nbsp;</tt><a name="(part._konffaa-license)"></a>License</h3><p>Except where otherwise noted, the following license applies:</p><p>Copyright &#169; 2009&ndash;2016 Helsinki Institute for Information
Technology HIIT, University of Bergen, and the authors.</p><p>Authors: Tero Hasu</p><p>Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation files
(the "Software"), to deal in the Software without restriction,
including without limitation the rights to use, copy, modify, merge,
publish, distribute, sublicense, and/or sell copies of the Software,
and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:</p><p>The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.</p><p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p></div></div><div id="contextindicator">&nbsp;</div></body></html>